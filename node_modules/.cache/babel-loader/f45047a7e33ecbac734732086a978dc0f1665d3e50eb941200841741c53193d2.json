{"ast":null,"code":"'use strict';\n\nmodule.exports.disposer = disposer;\nfunction disposer(creatorFn, disposerFn, fn) {\n  const runDisposer = function (resource, result) {\n    let shouldThrow = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    return disposerFn(resource).then(\n    // disposer resolved, do something with original fn's promise\n    () => {\n      if (shouldThrow) throw result;\n      return result;\n    },\n    // Disposer fn failed, crash process\n    err => {\n      throw err;\n      // Or process.exit?\n    });\n  };\n\n  return creatorFn.then(resource => {\n    // fn(resource) can throw, so wrap in a promise here\n    return Promise.resolve().then(() => fn(resource)).then(result => runDisposer(resource, result)).catch(err => runDisposer(resource, err, true));\n  });\n}","map":{"version":3,"names":["module","exports","disposer","creatorFn","disposerFn","fn","runDisposer","resource","result","shouldThrow","arguments","length","undefined","then","err","Promise","resolve","catch"],"sources":["/Users/user/node_modules/node-gyp/node_modules/cacache/lib/util/disposer.js"],"sourcesContent":["'use strict'\n\nmodule.exports.disposer = disposer\n\nfunction disposer (creatorFn, disposerFn, fn) {\n  const runDisposer = (resource, result, shouldThrow = false) => {\n    return disposerFn(resource)\n      .then(\n        // disposer resolved, do something with original fn's promise\n        () => {\n          if (shouldThrow)\n            throw result\n\n          return result\n        },\n        // Disposer fn failed, crash process\n        (err) => {\n          throw err\n          // Or process.exit?\n        })\n  }\n\n  return creatorFn\n    .then((resource) => {\n      // fn(resource) can throw, so wrap in a promise here\n      return Promise.resolve().then(() => fn(resource))\n        .then((result) => runDisposer(resource, result))\n        .catch((err) => runDisposer(resource, err, true))\n    })\n}\n"],"mappings":"AAAA,YAAY;;AAEZA,MAAM,CAACC,OAAO,CAACC,QAAQ,GAAGA,QAAQ;AAElC,SAASA,QAAQA,CAAEC,SAAS,EAAEC,UAAU,EAAEC,EAAE,EAAE;EAC5C,MAAMC,WAAW,GAAG,SAAAA,CAACC,QAAQ,EAAEC,MAAM,EAA0B;IAAA,IAAxBC,WAAW,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,KAAK;IACxD,OAAON,UAAU,CAACG,QAAQ,CAAC,CACxBM,IAAI;IACH;IACA,MAAM;MACJ,IAAIJ,WAAW,EACb,MAAMD,MAAM;MAEd,OAAOA,MAAM;IACf,CAAC;IACD;IACCM,GAAG,IAAK;MACP,MAAMA,GAAG;MACT;IACF,CAAC,CAAC;EACR,CAAC;;EAED,OAAOX,SAAS,CACbU,IAAI,CAAEN,QAAQ,IAAK;IAClB;IACA,OAAOQ,OAAO,CAACC,OAAO,EAAE,CAACH,IAAI,CAAC,MAAMR,EAAE,CAACE,QAAQ,CAAC,CAAC,CAC9CM,IAAI,CAAEL,MAAM,IAAKF,WAAW,CAACC,QAAQ,EAAEC,MAAM,CAAC,CAAC,CAC/CS,KAAK,CAAEH,GAAG,IAAKR,WAAW,CAACC,QAAQ,EAAEO,GAAG,EAAE,IAAI,CAAC,CAAC;EACrD,CAAC,CAAC;AACN"},"metadata":{},"sourceType":"script","externalDependencies":[]}